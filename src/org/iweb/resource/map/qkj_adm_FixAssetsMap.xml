<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"  "sql-map-2.dtd">
<sqlMap>
	<!-- Assets Start -->
	<typeAlias alias="fixassets" type="com.qkj.adm.domain.FixAssets" />
	<select id="adm_getFixAssetss" resultClass="fixassets" parameterClass="java.util.Map">
		<![CDATA[ 
			SELECT t.*,f.`typea` type_title,u.USER_NAME own_user_name  FROM qkja_r_fixassets t LEFT JOIN qkja_r_assetstype f ON (t.`typea`=f.`uuid`)
			LEFT JOIN s_sys_user u ON(u.uuid=t.`own_user`)
		]]>
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="uuid"><![CDATA[ t.uuid LIKE CONCAT('%',#uuid#,'%') ]]></isNotEmpty>
			<isNotEmpty prepend="AND" property="title"><![CDATA[ t.title LIKE CONCAT('%',#title#,'%') ]]></isNotEmpty>
			<isNotEmpty prepend="AND" property="p_company"><![CDATA[ t.p_company LIKE CONCAT('%',#p_company#,'%') ]]></isNotEmpty>
			<isNotEmpty prepend="AND" property="company"><![CDATA[ t.company=#company# ]]></isNotEmpty>
			<isNotEmpty prepend="AND" property="typea"><![CDATA[ t.typea=#typea# ]]></isNotEmpty>
			<isNotEmpty prepend="AND" property="p_time_start"><![CDATA[ t.p_time>=#p_time_start# ]]></isNotEmpty>
			<isNotEmpty prepend="AND" property="p_time_end"><![CDATA[ t.p_time<=DATE_ADD(#p_time_end#,INTERVAL 1 day) ]]></isNotEmpty>
			<isNotEmpty prepend="AND" property="residue_num_begin"><![CDATA[ t.residue_num >= #residue_num_begin# ]]></isNotEmpty>
			<isNotEmpty prepend="AND" property="residue_num_end"><![CDATA[ t.residue_num <= #residue_num_end# ]]></isNotEmpty>
		</dynamic>
	</select>
	<select id="adm_getFixAssetssCounts" resultClass="int" parameterClass="java.util.Map">
		<![CDATA[ 
			SELECT count(*) FROM qkja_r_fixassets t LEFT JOIN qkja_r_assetstype f ON (t.`typea`=f.`uuid`)
		]]>
		<dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="uuid"><![CDATA[ t.uuid LIKE CONCAT('%',#uuid#,'%')  ]]></isNotEmpty>
			<isNotEmpty prepend="AND" property="title"><![CDATA[ t.title LIKE CONCAT('%',#title#,'%') ]]></isNotEmpty>
			<isNotEmpty prepend="AND" property="p_company"><![CDATA[ t.p_company LIKE CONCAT('%',#p_company#,'%') ]]></isNotEmpty>
			<isNotEmpty prepend="AND" property="company"><![CDATA[ t.company=#company# ]]></isNotEmpty>
			<isNotEmpty prepend="AND" property="p_time_start"><![CDATA[ t.p_time>=#p_time_start# ]]></isNotEmpty>
			<isNotEmpty prepend="AND" property="p_time_end"><![CDATA[ t.p_time<=DATE_ADD(#p_time_end#,INTERVAL 1 day) ]]></isNotEmpty>
			<isNotEmpty prepend="AND" property="residue_num_begin"><![CDATA[ t.residue_num >= #residue_num_begin# ]]></isNotEmpty>
			<isNotEmpty prepend="AND" property="residue_num_end"><![CDATA[ t.residue_num <= #residue_num_end# ]]></isNotEmpty>
			<isNotEmpty prepend="AND" property="typea"><![CDATA[ t.typea=#typea# ]]></isNotEmpty>
		</dynamic>
	</select>
	<insert id="adm_addFixAssets" parameterClass="fixassets">
		<![CDATA[ 
			Insert Into qkja_r_fixassets(uuid,typea,p_mobile,p_company,warrantytime,title,num,company,p_time,p_scrap,price_scope,add_time,add_user,model,spec,price,position,own_user,use_time)
			Values (#uuid#,#typea#,#p_mobile#,#p_company#,#warrantytime#,#title#,#num#,#company#,#p_time#,#p_scrap#,#price_scope#,#add_time#,#add_user#,#model#,#spec#,#price#,#position#,#own_user#,#use_time#)
		]]>
	</insert>
	<update id="adm_mdyFixAssets" parameterClass="fixassets">
		<![CDATA[
			Update qkja_r_fixassets
			Set title=#title#,
				typea=#typea#,
				warrantytime=#warrantytime#,
				p_mobile=#p_mobile#,
				p_company=#p_company#,
				num=#num#,
				company=#company#,
				p_time=#p_time#,
				p_scrap=#p_scrap#,
				price_scope=#price_scope#,
				model=#model#,
				spec=#spec#,
				price=#price#,
				lm_user=#lm_user#,
				lm_time=#lm_time#,
				use_time=#use_time#,
				position=#position#,
				own_user=#own_user#
			Where uuid = #uuid#
		]]>
	</update>
	
	<update id="adm_mdyUserNum" parameterClass="fixassets">
		<![CDATA[
			Update qkja_r_fixassets
			Set 
				num=#num#,
				own_user=#own_user#
			Where uuid = #uuid#
		]]>
	</update>
	
	<update id="adm_mdyPositionNum" parameterClass="fixassets">
		<![CDATA[
			Update qkja_r_fixassets
			Set 
				num=#num#,
				position=#position#
			Where uuid = #uuid#
		]]>
	</update>
	
	<delete id="adm_delFixAssets" parameterClass="fixassets">
	<![CDATA[
		Delete From qkja_r_fixassets Where uuid=#uuid#
	]]>
	</delete>
	<!-- Assets End -->
</sqlMap>